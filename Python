#Filtrando campos nulos e exportando a base filtrada.


import numpy as np
import pandas as pd
import codecs
import unicodedata
import calendar
import locale
import datetime

# Setamos o local aonde está sendo executado o script, para extrair as datas em português
try:
    locale.setlocale(locale.LC_ALL, 'pt_BR')
    calendar.LocaleHTMLCalendar(calendar.SUNDAY, 'pt_BR')
except:
    locale.setlocale(locale.LC_ALL, 'Portuguese_Brazil')
    calendar.LocaleHTMLCalendar(calendar.SUNDAY, 'Portuguese_Brazil')
    
# Salvar na variável "agora" a data de execução e na variável mes_atual o mês de execução
agora = date.today()
mes_atual=agora.month

# Convertemos o número do mês no nome do mês
nome_mes = calendar.month_name[mes_atual]

# Obtendo os dados.
df_1 = pd.read_excel('x:/xx/base.xlsx', sheet_name = 'Plan1')

# Verificar as informações dos dados
df_1.info()

# Criando uma lista de variáveis que irão assumir os valores de acordo com cada condição.
conditions = [
    (df_2['colunaC'].isnull() == True),
    (df_2['colunaC'].isnull() == False)
     ]
valor = ['Sem_Informação', 'OK']

# Criando uma nova coluna a partir do np.select que vai atribuir a lista das variáveis às condições. 
df_1['Nova_Coluna'] = np.select(conditions, valor)

# Filtrando apenas o que não tem informação
df_2 = df_1[df_1.Nova_Coluna.isin(["Sem_Informação"])]

# Imprimir na tela caso a base não tenha campos em nulo, ou seja, quando fitrou acima por "Sem Informação", não há resultados. 
# Caso contrário, salve a base em excel no endereço informado.

If df_2.empty:
    print('Não há campos nulos.')
Else:
    df_2.to_excel('x:\\xxxx\\xxx\\base_filtrada.xlsx', encoding = 'ytf-8',index = False)
